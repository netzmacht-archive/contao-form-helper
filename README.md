Contao Form Helper - Extended form rendering
==================

This library provides extended form widget rendering for Contao frontend form widgets. By default the rendering of
Contao forms widgets are not very customizable because of inline html rendering. Adjust output can be quite difficult.

Contao Form Helper provides an event driven form rendering which is fully backward compatible. This means that it
supports the html output usually provided by Contao. Also every widgets from extension will work without any customizing.

Contao Form Helper renders the form in two steps. First it creates objects representing the HTML elements before passing
them to the templates. Using the event driven interface it is possible to simply change attributes, provide extra features
and so on.

Installation
-----

To install the extension simply install `netzmacht/contao-form-helper` using the
[Composer](http://c-c-a.org/ueber-composer) repository.

How it works
-----

By default this extension enables the extending form rendering for every form widget which are shipped with Contao. They
are activated using customized form templates.

The helper prepares 3 objects for the template:
 * Form label
 * Container including the element and by default the extra submit button
 * Error messages
 * Using a widget layout to arrange this elements

Each of the elements are objects, but can simply be generated by using `echo`:

```php
<?php

// form_widget.html5
$helper = Netzmacht\FormHelper\Helper::getInstance();
list($label, $container, $errors) = $helper->generate($this);

$layout = $helper->getLayout($this);
echo $this->getTemplate($layout);

```

Events
----------

Events are dispatched by the (Contao Event dispatcher)[https://github.com/contao-community-alliance/event-dispatcher].
Each event names are stored in `Netzmacht\FormHelper\Event\Events`:
 * `CREATE_ELEMENT` is fired as an factory event for creating Html elements by `Netzmacht\FormHelper\Html\Element::createElement`
 * `Events::BUILD_ELEMENT` is fired when creating the Html element of the given widget
 * `Events::PRE_GENERATE` is fired after creating the element
 * `Events::GENERATE` is fired after pregenerating
 * `Events::SELECT_LAYOUT` is fired to select the layout for the widget
 * `Events::SELECT_MESSAGE_LAYOUT` is fired by `form_message` template


Customizing widgets
----------

There are two possible ways for manipulating the output. One way can be using the events:

```php
<?php
// config.php

$GLOBALS['TL_EVENTS'][Netzmacht\FormHelper\Event\Events::GENERATE][] = function(Netzmacht\FormHelper\Event\GenerateEvent $event) {
	// access legacy widget and form
	$form 	= $event->getForm();
	$widget = $event->getWidget();

	// adjust element
	$container = $event->getContainer();
	$element   = $container->getElement();

	// adjust rows
	if($form->id == 9 && $widget->type == 'textarea') {
		$element->setAttribute('rows', 50);
	}

	// set options
	if($element->getAttribute('name') == 'street' && $element instanceof Netzmacht\FormHelper\Html\Element\Select) {
		$streets = array(
			array(
				'value' => 'Hauptstraße',
				'label' => 'Haupstraße',
				'default' => false
			),
			array(
				'value' => 'Kirchweg',
				'label' => 'Kirchweg',
				'default' => true
			)
		);

		$element->setOptions($streets);
	}
}
```

You can also adjust the rendering using the templates:

```php
<?php
// form_widget.html5
$helper = Netzmacht\FormHelper\Helper::getInstance();
list($label, $container, $errors) = $helper->generate($this);

// wrapping element can be a string with %s placeholder or an Netzmacht\FormHelper\Html\Node object
$wrapper = '<div class="form-element">%s</div>';
$container->add('wrapper', $wrapper, $container::POSITION_WRAPPER);

<?php

$layout = $helper->getLayout($this);
echo $this->getTemplate($layout);